{
  "name": "convert",
  "uri": "/sas2py/convert",
  "methods": ["POST"],
  "upstream": {
    "type": "roundrobin",
    "nodes": {
      "${environments.${environment}.urls.groq_base_url}": 1
    },
    "timeout": {
      "connect": 60,
      "send": 60,
      "read": 60
    }
  },
  "plugins": {
    "jwt-auth": {},
    "request-id": {
      "header_name": "X-Request-Id",
      "include_in_response": true,
      "algorithm": "uuid"
    },
    "prometheus": {
      "prefer_name": true
    },
    "ai-prompt-template": {
      "templates": [
        {
          "name": "converter",
          "template": {
            "model": "llama-3.1-8b-instant",
            "input": {
              "text_input": "{{user_input}}",
              "parameters": {
                "temperature": 0.2,
                "max_tokens": 2000
              }
            }
          }
        }
      ],
      "_meta": { "priority": 2520 }
    },
    "proxy-rewrite": {
      "uri": "/v2/models/llama-3.1-8b-instant/infer",
      "host": "triton-server.local",
      "headers": {
        "Authorization": "Bearer ${environments.common.secrets.groq_api_key}",
        "Content-Type": "application/json"
      }
    },
    "response-rewrite": {
      "headers": {
        "remove": ["Content-Encoding"]
      }
    }
  }
}
