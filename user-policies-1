if allowed_model:
    policy_info["allowed_models"] = allowed_models_info
    
    # Create deploy_models structure using the combined inference_type string
    deploy_models = {}
    for model_info in allowed_models_info:
        model_name = model_info.get("model_name", "")
        if model_name:
            model_deployments = []
            for framework in model_info.get("frameworks", []):
                inference_type = framework.get("inference_type", "")
                if inference_type:  # Only add if inference_type exists
                    model_deployments.append({
                        "inference_type": inference_type,
                        "tasks": framework.get("tasks", 2)  # Default to 2 if not specified
                    })
            
            if model_deployments:
                deploy_models[model_name] = model_deployments
    
    policy_info["deploy_models"] = deploy_models
